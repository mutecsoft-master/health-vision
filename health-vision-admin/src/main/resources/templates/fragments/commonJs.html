<th:block th:fragment="commonJs">
  <!-- jQuery -->
  <script th:src="@{/admin/static/plugins/jquery/jquery.min.js}"></script>
  <!-- jQuery UI 1.11.4 -->
  <script th:src="@{/admin/static/plugins/jquery-ui/jquery-ui.min.js}"></script>
  <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
  <script>
    $.widget.bridge('uibutton', $.ui.button)
  </script>
  <!-- Bootstrap 4 -->
  <script th:src="@{/admin/static/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
  <!-- daterangepicker -->
  <script th:src="@{/admin/static/plugins/moment/moment.min.js}"></script>
  <script th:src="@{/admin/static/plugins/daterangepicker/daterangepicker.js}"></script>
  <!-- overlayScrollbars -->
  <script th:src="@{/admin/static/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js}"></script>
  <!-- AdminLTE App -->
  <script th:src="@{/admin/static/adminlte/js/adminlte.min.js}"></script>

  <!-- DataTables  & Plugins -->
  <script th:src="@{/admin/static/plugins/datatables/jquery.dataTables.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-responsive/js/dataTables.responsive.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-responsive/js/responsive.bootstrap4.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-buttons/js/dataTables.buttons.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-buttons/js/buttons.bootstrap4.min.js}"></script>
  <script th:src="@{/admin/static/plugins/jszip/jszip.min.js}"></script>
  <script th:src="@{/admin/static/plugins/pdfmake/pdfmake.min.js}"></script>
  <script th:src="@{/admin/static/plugins/pdfmake/vfs_fonts.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-buttons/js/buttons.html5.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-buttons/js/buttons.print.min.js}"></script>
  <script th:src="@{/admin/static/plugins/datatables-buttons/js/buttons.colVis.min.js}"></script>

  <!-- Tempusdominus Bootstrap 4 -->
  <script th:src="@{/admin/static/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js}"></script>

  <script>
    $(function() {
      // active sidebar menu
      const currentPath = window.location.pathname;
      $('.nav-sidebar .nav-link').each(function () {
        const $link = $(this);
        const href = $link.attr('href');

        if (href && currentPath == href) {
          $link.addClass('active');

          // 트리 구조 메뉴라면 상위 nav-item도 열어줘야 함
          const $treeviewMenu = $link.closest('.nav-treeview');
          if ($treeviewMenu.length) {
            const $parentNavItem = $treeviewMenu.closest('.nav-item');
            if ($parentNavItem.length) {
              $parentNavItem.addClass('menu-open');

              // 상위 .nav-link에도 active 추가
              const $parentLink = $parentNavItem.children('.nav-link');
              if ($parentLink.length) {
                $parentLink.addClass('active');
              }
            }
          }
        }
      });

      //form 초기화
      $('[data-action="form-reset"]').on('click', function () {
        const $form = $(this).closest('form');
        $form[0].reset();

        // datetimepicker는 별도로 초기화
        $form.find('.input-group.date').each(function () {
          $(this).datetimepicker('clear');
        });
        
      });

      //체크박스 전체선택
      $('#chkAll').change(function() {
        var $table = $(this).closest('table');
        var checked = $(this).prop('checked');
        $table.find('tbody input[type="checkbox"]').prop('checked', checked);
      });

      //체크박스 전체선택 해제
      $('table tbody input[type="checkbox"]').change(function () {
        var $table = $(this).closest('table');
        var total = $table.find('tbody input[type="checkbox"]').length;
        var checked = $table.find('tbody input[type="checkbox"]:checked').length;
        $table.find('#chkAll').prop('checked', total === checked);
      });

    });

  </script>

</th:block>

